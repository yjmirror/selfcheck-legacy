{"code":"var a=Object.create,n=Object.defineProperty,g=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,h=Object.getOwnPropertyNames,_=Object.getOwnPropertyDescriptor,c=s=>n(s,\"__esModule\",{value:!0}),d=(s,t)=>{c(s);for(var e in t)n(s,e,{get:t[e],enumerable:!0})},C=(s,t,e)=>{if(c(s),typeof t==\"object\"||typeof t==\"function\")for(let r of h(t))!E.call(s,r)&&r!==\"default\"&&n(s,r,{get:()=>t[r],enumerable:!(e=_(t,r))||e.enumerable});return s},I=s=>s&&s.__esModule?s:C(n(a(g(s)),\"default\",{value:s,enumerable:!0}),s);d(exports,{default:()=>U});const o={SEARCH_SCHOOL:\"/v2/searchSchool\",FIND_USER:\"/v2/findUser\",UPDATE_AGREEMENT:\"/v2/updatePInfAgrmYn\",HAS_PASSWORD:\"/v2/hasPassword\",REGISTER_PASSWORD:\"/v2/registerPassword\",LOGIN_WITH_SECOND_PASSWORD:\"/v2/validatePassword\",INIT_PASSWORD:\"/v2/initPassword\",SEND_SURVEY_RESULT:\"/registerServey\",SELECT_GROUP_LIST:\"/v2/selectUserGroup\",REFRESH_USER_INFO:\"/v2/getUserInfo\",REGISTER_GROUP_LIST:\"/v2/insertUserInGroup\",REMOVE_GROUP_LIST:\"/v2/removeUserInGroup\",TEACHER_CLASS_LIST:\"/joinClassList\",MANAGER_CLASS_LIST:\"/joinDeptList\",CLASS_JOIN_LIST:\"/join\",DEPT_JOIN_LIST:\"/joinTchr\",JOIN_DETAIL:\"/joinDetail\",SEND_PUSH:\"/push\",SELECT_NOTICE_LIST:\"/v2/selectNoticeList\",SELECT_NOTICE_CONTENTS:\"/v2/selectNotice\"};function l(s){return s.includes(\"남\")?i(s[0]+\"남\"):s.includes(\"북\")?i(s[0]+\"북\"):i(s.slice(0,2))}function i(s){if(T.includes(s))return s;throw new Error(`Unexpected area \"${s}\"`)}const T=[\"서울\",\"부산\",\"대구\",\"인천\",\"광주\",\"대전\",\"울산\",\"세종\",\"경기\",\"강원\",\"충북\",\"충남\",\"전북\",\"전남\",\"경북\",\"경남\",\"제주\"],S=I(require(\"assert\"));class f{constructor(s,t){this.ctx=t,this.user=s}async searchSchool(){const{school:s,area:t}=this.user,{schulList:[{orgCode:e,atptOfcdcConctUrl:r}]}=await this.ctx.get(o.SEARCH_SCHOOL,{params:{schulCrseScCode:L(A(s)),lctnScCode:R(l(t)),orgName:s,currentPageNo:1}});this.schoolInfo={orgCode:e,baseURL:r}}async getToken(){const{name:s,birthday:t}=this.user,{orgCode:e,baseURL:r}=this.schoolInfo;S.default(e&&r,\"cannot find school\");const p={name:this.ctx.encrypt(s),birthday:this.ctx.encrypt(t),orgCode:e,loginType:\"school\",stdntPNo:null},{token:u}=await this.ctx.post(o.FIND_USER,p,{baseURL:r});this.token=u}async sendSurvey(){const s={rspns00:\"Y\",rspns01:\"1\",rspns02:\"1\",rspns03:null,rspns04:null,rspns05:null,rspns06:null,rspns07:\"0\",rspns08:\"0\",rspns09:\"0\",rspns10:null,rspns11:null,rspns12:null,rspns13:null,rspns14:null,rspns15:null,deviceUuid:\"\",upperToken:this.token,upperUserNameEncpt:this.user.name};return await this.ctx.post(o.SEND_SURVEY_RESULT,s,this.schoolInfo)}}function A(s){if(s.endsWith(\"학교\"))return s.endsWith(\"초등학교\")?\"초등학교\":s.endsWith(\"중학교\")?\"중학교\":s.endsWith(\"고등학교\")?\"고등학교\":\"특수학교\";{const t=s[s.length-1];if(t===\"초\")return\"초등학교\";if(t===\"중\")return\"중학교\";if(t===\"고\")return\"고등학교\";if(s.includes(\"유치\")||t===\"집\")return\"유치원\";throw new Error(\"unexpected school name\")}}function L(s){return{유치원:\"1\",초등학교:\"2\",중학교:\"3\",고등학교:\"4\",특수학교:\"5\"}[s]}function R(s){return{서울:\"01\",부산:\"02\",대구:\"03\",인천:\"04\",광주:\"05\",대전:\"06\",울산:\"07\",세종:\"08\",경기:\"10\",강원:\"11\",충북:\"12\",충남:\"13\",전북:\"14\",전남:\"15\",경북:\"16\",경남:\"17\",제주:\"18\"}[s]}var U=async(s,t)=>{const e=new f(s,t);return await e.searchSchool(),await e.getToken(),e.sendSurvey()};\n","version":1,"options":{}}
