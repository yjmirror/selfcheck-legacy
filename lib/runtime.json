{"code":"var a=Object.create,n=Object.defineProperty,g=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,h=Object.getOwnPropertyNames,_=Object.getOwnPropertyDescriptor,c=t=>n(t,\"__esModule\",{value:!0}),d=(t,e)=>{c(t);for(var s in e)n(t,s,{get:e[s],enumerable:!0})},C=(t,e,s)=>{if(c(t),typeof e==\"object\"||typeof e==\"function\")for(let r of h(e))!E.call(t,r)&&r!==\"default\"&&n(t,r,{get:()=>e[r],enumerable:!(s=_(e,r))||s.enumerable});return t},I=t=>t&&t.__esModule?t:C(n(a(g(t)),\"default\",{value:t,enumerable:!0}),t);d(exports,{default:()=>U});const o={SEARCH_SCHOOL:\"/v2/searchSchool\",FIND_USER:\"/v2/findUser\",UPDATE_AGREEMENT:\"/v2/updatePInfAgrmYn\",HAS_PASSWORD:\"/v2/hasPassword\",REGISTER_PASSWORD:\"/v2/registerPassword\",LOGIN_WITH_SECOND_PASSWORD:\"/v2/validatePassword\",INIT_PASSWORD:\"/v2/initPassword\",SEND_SURVEY_RESULT:\"/registerServey\",SELECT_GROUP_LIST:\"/v2/selectUserGroup\",REFRESH_USER_INFO:\"/v2/getUserInfo\",REGISTER_GROUP_LIST:\"/v2/insertUserInGroup\",REMOVE_GROUP_LIST:\"/v2/removeUserInGroup\",TEACHER_CLASS_LIST:\"/joinClassList\",MANAGER_CLASS_LIST:\"/joinDeptList\",CLASS_JOIN_LIST:\"/join\",DEPT_JOIN_LIST:\"/joinTchr\",JOIN_DETAIL:\"/joinDetail\",SEND_PUSH:\"/push\",SELECT_NOTICE_LIST:\"/v2/selectNoticeList\",SELECT_NOTICE_CONTENTS:\"/v2/selectNotice\"};function l(t){return t.includes(\"남\")?i(t[0]+\"남\"):t.includes(\"북\")?i(t[0]+\"북\"):i(t.slice(0,2))}function i(t){if(T.includes(t))return t;throw new Error(`Unexpected area \"${t}\"`)}const T=[\"서울\",\"부산\",\"대구\",\"인천\",\"광주\",\"대전\",\"울산\",\"세종\",\"경기\",\"강원\",\"충북\",\"충남\",\"전북\",\"전남\",\"경북\",\"경남\",\"제주\"],S=I(require(\"assert\"));class f{constructor(t,e){this.ctx=e,this.user=t}async searchSchool(){const{school:t,area:e}=this.user,{schulList:[{orgCode:s,atptOfcdcConctUrl:r}]}=await this.ctx.get(o.SEARCH_SCHOOL,{params:{schulCrseScCode:L(A(t)),lctnScCode:R(l(e)),orgName:t,currentPageNo:1}});this.schoolInfo={orgCode:s,baseURL:r}}async getToken(){const{name:t,birthday:e}=this.user,{orgCode:s,baseURL:r}=this.schoolInfo;S.default(s&&r,\"cannot find school\");const p={name:this.ctx.encrypt(t),birthday:this.ctx.encrypt(e),orgCode:s,loginType:\"school\",stdntPNo:null},{token:u}=await this.ctx.post(o.FIND_USER,p,{baseURL:r});this.token=u}async sendSurvey(){const t={rspns00:\"Y\",rspns01:\"1\",rspns02:\"1\",rspns03:null,rspns04:null,rspns05:null,rspns06:null,rspns07:\"0\",rspns08:\"0\",rspns09:\"0\",rspns10:null,rspns11:null,rspns12:null,rspns13:null,rspns14:null,rspns15:null,deviceUuid:\"\",upperToken:this.token,upperUserNameEncpt:this.user.name};return await this.ctx.post(o.SEND_SURVEY_RESULT,t,this.schoolInfo)}}function A(t){if(t.endsWith(\"학교\"))return t.endsWith(\"초등학교\")?\"초등학교\":t.endsWith(\"중학교\")?\"중학교\":t.endsWith(\"고등학교\")?\"고등학교\":\"특수학교\";{const e=t[t.length-1];if(e===\"초\")return\"초등학교\";if(e===\"중\")return\"중학교\";if(e===\"고\")return\"고등학교\";if(t.includes(\"유치\")||e===\"집\")return\"유치원\";throw new Error(\"unexpected school name\")}}function L(t){return{유치원:\"1\",초등학교:\"2\",중학교:\"3\",고등학교:\"4\",특수학교:\"5\"}[t]}function R(t){return{서울:\"01\",부산:\"02\",대구:\"03\",인천:\"04\",광주:\"05\",대전:\"06\",울산:\"07\",세종:\"08\",경기:\"10\",강원:\"11\",충북:\"12\",충남:\"13\",전북:\"14\",전남:\"15\",경북:\"16\",경남:\"17\",제주:\"18\"}[t]}var U=async(t,e)=>{const s=new f(t,e);try{return await s.searchSchool(),await s.getToken(),s.sendSurvey()}catch(r){throw console.error(r),r}};\n","version":1,"options":{}}
